
- [kernel Kconfig defconfig .config](#kernel-kconfig-defconfig-config)
  - [GoogleHome config](#googlehome-config)
  - [以添加一个具体驱动为例](#以添加一个具体驱动为例)
- [ALSA](#alsa)
- [BuildRoot](#buildroot)
- [linux DebugFS](#linux-debugfs)
- [cdev.owner](#cdevowner)

----

> - 嵌入式硬件设计
> - 深入Linux内核架构（中文版）
> - 深入Linux设备驱动程序内核机制
> - ARM体系结构与编程
> - Linux设备驱动程序
> - 跟我一起写Makefile
> - python 脚本
> - ARM嵌入式系统开发-软件设计与优化

## kernel Kconfig defconfig .config

- defconfig 一般在arch/arm64/configs/目录下，是一个没有展开的内核配置，需要配合Kconfig展开成 .config

- 从 defconfig 到 `.config` 不是简单的复制操作，而是 make ARCH=arm64 defconfig

- `.confg` 也不是直接拷贝成 defconfig ，而是使用 make ARCH=arm64 savedefconfig

正确使用和保存deconfig的流程：
- 1. 要修改在 arch/arm/configs 下的文件 xxx_defconfig  (会去读取 Kconfig 找到 xxx_defconfig)
- 2. make ARCH=arm64 xxx_defconfig 会生成 `.config` 文件
- 3. make ARCH=arm64 menuconfig 修改配置后保存（设置 `.config`）
- 4. make ARCH=arm64 savedefconfig 生成 defconfg 文件
- 5. cp defconfig arch/arm/configs/xxx_defconfig 保存
这样保存的 defconfig 文件，配置最小化，且日后能恢复成 `.config` 。

> make menuconfig -- 从Kconfig中读出配置菜单 保存到 `.config`

> **内核编译时：主 Makefile 调用这个** `.config`

### GoogleHome config

defconfig 是没有隐藏依赖的，直接 make menuconfig 生成 .config , 然后和 defconfig 对比，然后拷贝即可，使用 build_kernel 编译的时候会去 diff defconfig 和 `.config` 。

### 以添加一个具体驱动为例

> 以 Amlogic的 A311D 芯片为例

- 找到 arch/arm64/configs/aplex_cmi_aa158_defconfig（这个可以从芯片官网下载）

- 加载配置

make aplex_cmi_aa158_defconfig ARCH=arm64

> 就是把 arch/arm64/configs/aplex_cmi_aa158_defconfig 里面的配置写到了 Linux 代码目录下的 .config 文件里面。

- 执行 make menuconfig ARCH=arm64 , make menuconfig 操作就是把 .config 文件里面的配置读取出来，然后显示在一个可视化的界面里：

- 保存配置 make savedefconfig  ARCH=arm64

> 执行完毕之后，会生成一个保存的配置文件为： `defconfig`

- 再把 defconfig 文件配置覆盖先前的配置

cp  defconfig  arch/arm64/configs/aplex_cmi_aa158_defconfig -rf 







## ALSA

## BuildRoot

## linux DebugFS

## cdev.owner